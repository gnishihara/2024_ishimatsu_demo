[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Model examples",
    "section": "",
    "text": "This is an example of using three different methods to analyze data with the following characteristics.\n\nMultiple observations per individual\nA discrete independent variable\n\n\nRead packages\n\nlibrary(tidyverse) # Modern R\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(emmeans)   # Pair-wise comparisons\nlibrary(lme4)      # Random effect models\n\nLoading required package: Matrix\n\nAttaching package: 'Matrix'\n\nThe following objects are masked from 'package:tidyr':\n\n    expand, pack, unpack\n\nlibrary(lmerTest)  # ANOVA table for random effect model\n\n\nAttaching package: 'lmerTest'\n\nThe following object is masked from 'package:lme4':\n\n    lmer\n\nThe following object is masked from 'package:stats':\n\n    step\n\n\n\n\nPrepare demonstration data\n\ndset = as_tibble(iris)\ndset = dset |&gt; \n  mutate(Sepal = Sepal.Length * Sepal.Width,\n         Petal = Petal.Length * Petal.Width) |&gt; \n  select(Species, Sepal, Petal) |&gt; \n  group_by(Species) |&gt; \n  slice_sample(n = 20) |&gt; \n  mutate(n = 1:n()) |&gt; \n  ungroup()\n\nThis data is a modified version from the iris dataset in R. I calculated the area of the Sepal and Petal for each Species (I. setosa, I. versicolor, and I. virginica), so that it appears similar to your fish gill-branch area data.\n\nggplot(dset) + \n  geom_point(aes(x = Sepal, y = Petal, color = Species)) +\n  labs(title = \"The area of the sepal and petal for each Iris species.\")\n\n\n\n\n\n\n\n\n\n\nTraditional one-way ANOVA\nIn a simple one-way ANOVA, we first sum the area of the sepal and the petal.\n\nd1 = dset |&gt; \n  mutate(Area = Sepal + Petal)\n\n\nggplot(d1) + \n  geom_point(aes(x = Species, y = Area, color = Species),\n             position = position_jitter(0.1)) +\n  labs(title = \"Is the mean area different among treatment effect?\")\n\n\n\n\n\n\n\n\nThen we test the null hypothesis that the mean value of the Area is similar across treatment effect (Species).\n\nm1 = lm(Area ~ Species, data = d1)\nsummary.aov(m1)\n\n            Df Sum Sq Mean Sq F value   Pr(&gt;F)    \nSpecies      2   1893   946.6   49.49 3.46e-13 ***\nResiduals   57   1090    19.1                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nAt a significance level of 0.05, the results are significant. Next we could use a TukeyHSD test to test for post-hoc pair-wise differences in the mean area.\n\nemmeans(m1, specs = pairwise ~ Species, type = \"Tukey\")\n\n$emmeans\n Species    emmean    SE df lower.CL upper.CL\n setosa       17.7 0.978 57     15.8     19.7\n versicolor   23.7 0.978 57     21.7     25.6\n virginica    31.5 0.978 57     29.5     33.4\n\nConfidence level used: 0.95 \n\n$contrasts\n contrast               estimate   SE df t.ratio p.value\n setosa - versicolor       -5.94 1.38 57  -4.297  0.0002\n setosa - virginica       -13.72 1.38 57  -9.920  &lt;.0001\n versicolor - virginica    -7.78 1.38 57  -5.623  &lt;.0001\n\nP value adjustment: tukey method for comparing a family of 3 estimates \n\n\nIf we look a the $contrast output, we can see that the difference are significant among all pair-wise comparisons.\n\n\nMultivariate ANOVA (MANOVA)\nMy preferred method for this type of data, where there are multiple dependent variables for each sample, would be a multivariate ANOVA. In this case, Sepal and Petal are multiple observations for each sample (i.e., dependent variable) and the Species is the independent variable.\n\nggplot(d1) + \n  geom_point(aes(x = Sepal, y = Petal, color = Species)) +\n  labs(title = \"Is the mean area of the Sepal and Petal different among treatment effect?\")\n\n\n\n\n\n\n\n\nHere, we test the hypothesis that the mean area of the Sepal and Petal are similar across treatment effect (Species).\n\nm2 = lm(cbind(Sepal, Petal) ~ Species, data = d1)\nmanova_result = manova(m2)\nsummary(manova_result, test = \"Pillai\")\n\n          Df  Pillai approx F num Df den Df    Pr(&gt;F)    \nSpecies    2 0.93905   25.225      4    114 5.616e-15 ***\nResiduals 57                                             \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nAccording to the Pillai statistic, the null hypothesis can be rejected at the 0.05 significance level.\n\nemmeans(manova_result, specs = pairwise ~ Species, type = \"Tukey\")\n\n$emmeans\n Species    emmean    SE df lower.CL upper.CL\n setosa       8.87 0.489 57     7.89     9.85\n versicolor  11.84 0.489 57    10.86    12.82\n virginica   15.73 0.489 57    14.75    16.71\n\nResults are averaged over the levels of: rep.meas \nConfidence level used: 0.95 \n\n$contrasts\n contrast               estimate    SE df t.ratio p.value\n setosa - versicolor       -2.97 0.691 57  -4.297  0.0002\n setosa - virginica        -6.86 0.691 57  -9.920  &lt;.0001\n versicolor - virginica    -3.89 0.691 57  -5.623  &lt;.0001\n\nResults are averaged over the levels of: rep.meas \nP value adjustment: tukey method for comparing a family of 3 estimates \n\n\nThe TukeyHSD test also indicates significant difference in pair-wise comparisons.\n\n\nOne-way ANOVA with a random effect\nRandom effect models are very tricky. Please read Ben Bolker’s FAQ on GLMMs, which deals with random effect models. Especially read the discussion regardin “Should I treat factor xxx as fixed or random?”\nURL: https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html\nIn this case the fixed effect is Species and the random effect is Organ. In your fish data, the fixed effect would be the treatment and the random effect would be gill arch #.\n\ndset2 = \n  dset |&gt; \n  pivot_longer(cols = c(Sepal, Petal),\n               names_to = \"Organ\",\n               values_to = \"Area\") |&gt; \n  mutate(Organ = factor(Organ),\n         Species = factor(Species))\n\nThe null hypothesis for the fixed effect is similar to that of the simple ANOVA.\n\nm3 = lmer(Area ~ Species +(1 | Organ), data = dset2)\nsummary(m3)\n\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: Area ~ Species + (1 | Organ)\n   Data: dset2\n\nREML criterion at convergence: 614.6\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-2.8110 -0.7234 -0.1117  0.6615  3.2182 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n Organ    (Intercept) 77.25    8.789   \n Residual              9.66    3.108   \nNumber of obs: 120, groups:  Organ, 2\n\nFixed effects:\n                  Estimate Std. Error      df t value Pr(&gt;|t|)    \n(Intercept)          8.869      6.234   1.008   1.423    0.389    \nSpeciesversicolor    2.971      0.695 116.000   4.275 3.94e-05 ***\nSpeciesvirginica     6.859      0.695 116.000   9.870  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) Spcsvrs\nSpecsvrsclr -0.056        \nSpecisvrgnc -0.056  0.500 \n\n\nNote there is output for randome effect, fixed effect, and the correlation among fixed effects. The P-values for the random effects model is provided below and indicates that null hypothesis can be rejected.\n\nanova(m3)\n\nType III Analysis of Variance Table with Satterthwaite's method\n        Sum Sq Mean Sq NumDF DenDF F value    Pr(&gt;F)    \nSpecies 946.59  473.29     2   116  48.995 3.766e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\nThe TukeyHSD test also indicates significant difference in pair-wise comparisons.\n\nemmeans(m3, specs = pairwise ~ Species, type = \"Tukey\")\n\n$emmeans\n Species    emmean   SE   df lower.CL upper.CL\n setosa       8.87 6.23 1.01    -68.8     86.6\n versicolor  11.84 6.23 1.01    -65.8     89.5\n virginica   15.73 6.23 1.01    -62.0     93.4\n\nDegrees-of-freedom method: kenward-roger \nConfidence level used: 0.95 \n\n$contrasts\n contrast               estimate    SE  df t.ratio p.value\n setosa - versicolor       -2.97 0.695 116  -4.275  0.0001\n setosa - virginica        -6.86 0.695 116  -9.870  &lt;.0001\n versicolor - virginica    -3.89 0.695 116  -5.594  &lt;.0001\n\nDegrees-of-freedom method: kenward-roger \nP value adjustment: tukey method for comparing a family of 3 estimates"
  }
]